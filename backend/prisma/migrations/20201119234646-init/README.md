# Migration `20201119234646-init`

This migration has been generated by Karim Abedrabbo at 11/19/2020, 3:46:46 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."ProfileVisibility" AS ENUM ('NONE', 'FULL')

CREATE TYPE "public"."StudentType" AS ENUM ('GENERAL', 'INTERNATIONAL', 'FIRSTGEN', 'TRANSFER')

CREATE TABLE "public"."User" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"name" text   ,
"biography" text   ,
"class" text   ,
"major" text   ,
"profileVisibility" "ProfileVisibility"  NOT NULL DEFAULT E'FULL',
"linkedin" text   ,
"facebook" text   ,
"twitter" text   ,
"instagram" text   ,
"snapchat" text   ,
"tiktok" text   ,
"openToHelp" boolean   DEFAULT true,
"studentType" "StudentType"  NOT NULL DEFAULT E'GENERAL',
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Category" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"name" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Question" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"title" text   NOT NULL ,
"description" text   ,
"deletedAt" timestamp(3)   ,
"userId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."QuestionVote" (
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"upDown" boolean   NOT NULL ,
"questionId" text   NOT NULL ,
"userId" text   NOT NULL ,
PRIMARY KEY ("questionId","userId")
)

CREATE TABLE "public"."QuestionClick" (
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"questionId" text   NOT NULL ,
"userId" text   NOT NULL ,
PRIMARY KEY ("questionId","userId")
)

CREATE TABLE "public"."Answer" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"content" text   NOT NULL ,
"questionId" text   NOT NULL ,
"deletedAt" timestamp(3)   ,
"userId" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."AnswerVote" (
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"upDown" boolean   NOT NULL ,
"answerId" text   NOT NULL ,
"userId" text   NOT NULL ,
PRIMARY KEY ("answerId","userId")
)

CREATE TABLE "public"."Chatroom" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Message" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"content" text   NOT NULL ,
"userId" text   NOT NULL ,
"chatroomId" text   ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_ChatroomToUser" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_CategoryToQuestion" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE INDEX "User.name_index" ON "public"."User"("name")

CREATE INDEX "User.biography_index" ON "public"."User"("biography")

CREATE UNIQUE INDEX "Category.name_unique" ON "public"."Category"("name")

CREATE INDEX "Question.title_index" ON "public"."Question"("title")

CREATE INDEX "Question.description_index" ON "public"."Question"("description")

CREATE INDEX "Answer.content_index" ON "public"."Answer"("content")

CREATE UNIQUE INDEX "_ChatroomToUser_AB_unique" ON "public"."_ChatroomToUser"("A", "B")

CREATE INDEX "_ChatroomToUser_B_index" ON "public"."_ChatroomToUser"("B")

CREATE UNIQUE INDEX "_CategoryToQuestion_AB_unique" ON "public"."_CategoryToQuestion"("A", "B")

CREATE INDEX "_CategoryToQuestion_B_index" ON "public"."_CategoryToQuestion"("B")

ALTER TABLE "public"."Question" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."QuestionVote" ADD FOREIGN KEY ("questionId")REFERENCES "public"."Question"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."QuestionVote" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."QuestionClick" ADD FOREIGN KEY ("questionId")REFERENCES "public"."Question"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."QuestionClick" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Answer" ADD FOREIGN KEY ("questionId")REFERENCES "public"."Question"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Answer" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."AnswerVote" ADD FOREIGN KEY ("answerId")REFERENCES "public"."Answer"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."AnswerVote" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("chatroomId")REFERENCES "public"."Chatroom"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."_ChatroomToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Chatroom"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ChatroomToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CategoryToQuestion" ADD FOREIGN KEY ("A")REFERENCES "public"."Category"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_CategoryToQuestion" ADD FOREIGN KEY ("B")REFERENCES "public"."Question"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201119234646-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,163 @@
+datasource db {
+  url = "***"
+  provider = "postgresql"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id                String            @id 
+  createdAt         DateTime          @default(now())
+  updatedAt         DateTime          @updatedAt
+  name              String?
+  biography         String?
+  class             String?
+  major             String?
+  profileVisibility ProfileVisibility @default(FULL)
+  linkedin          String?
+  facebook          String?
+  twitter           String?
+  instagram         String?
+  snapchat          String?
+  tiktok            String?
+  openToHelp        Boolean? @default(true)
+  studentType       StudentType       @default(GENERAL)
+  chatrooms         Chatroom[]
+  questions         Question[]
+  questionVotes     QuestionVote[]
+  questionClicks    QuestionClick[]
+  answerVotes       AnswerVote[]
+  answers           Answer[]
+  messages          Message[]
+
+  @@index([name])
+  @@index([biography])
+}
+
+enum ProfileVisibility {
+  NONE
+  FULL
+}
+
+model Category {
+  id        String     @id @default(cuid())
+  createdAt DateTime   @default(now())
+  updatedAt DateTime   @updatedAt
+  name      String     @unique
+  questions Question[]
+}
+
+model Question {
+  id          String          @id @default(cuid())
+  createdAt   DateTime        @default(now())
+  updatedAt   DateTime        @updatedAt
+  title       String
+  description String?
+  votes       QuestionVote[]
+  clicks      QuestionClick[]
+  answers     Answer[]
+  deletedAt   DateTime?
+
+  user   User   @relation(fields: [userId], references: [id])
+  userId String
+
+  categories Category[]
+
+  @@index([title])
+  @@index([description])
+}
+
+model QuestionVote {
+
+  @@id([ questionId, userId ])
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  upDown Boolean
+
+  question   Question @relation(fields: [questionId], references: [id])
+  questionId String
+
+  user   User   @relation(fields: [userId], references: [id])
+  userId String
+}
+
+model QuestionClick {
+
+  @@id([ questionId, userId ])
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  question   Question @relation(fields: [questionId], references: [id])
+  questionId String
+
+  user   User   @relation(fields: [userId], references: [id])
+  userId String
+}
+
+model Answer {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  content String
+  votes   AnswerVote[]
+
+  question   Question @relation(fields: [questionId], references: [id])
+  questionId String
+
+  deletedAt DateTime?
+
+  user   User   @relation(fields: [userId], references: [id])
+  userId String
+
+  @@index([content])
+
+}
+
+model AnswerVote {
+
+  @@id([ answerId, userId ])
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  upDown Boolean
+
+  answer   Answer @relation(fields: [answerId], references: [id])
+  answerId String
+
+  user   User   @relation(fields: [userId], references: [id])
+  userId String
+}
+
+model Chatroom {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+  messages Message[]
+
+  users User[]
+}
+
+model Message {
+  id         String    @id @default(cuid())
+  createdAt  DateTime  @default(now())
+  updatedAt  DateTime  @updatedAt
+  content    String
+  user       User      @relation(fields: [userId], references: [id])
+  userId     String
+  chatroom   Chatroom? @relation(fields: [chatroomId], references: [id])
+  chatroomId String?
+}
+
+enum StudentType {
+  GENERAL
+  INTERNATIONAL
+  FIRSTGEN
+  TRANSFER
+}
+
```


